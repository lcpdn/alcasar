# $Id: CHANGELOG 1764 2016-01-14 23:12:59Z richard $
************ ALCASAR CHANGELOG *********** 

-----------------------2.9.2 -----------------------
NEWS
	- importation of official certificate 
	- Configuration of Dansguardian and DNSMASQ for larger sites
	- The SSL level has been improved to avoid recent vulnerabilities (exclude SSLV2 & V3)
	- The autosigned certificate has been improved (key lenght : 2048b and sha256 for fingerprint algorithm)
	- MAC auth equipments are automatically logged just after creation
BUGS
	- MAC auth equipments in DHCP mode are logout after lease time. They can't be automatically reconnected
ACC
	- PHP : migration of the deprecated functions --> should be continued for the V3
------------------------2.9-1 ------------------------

BUGS
	- Problem with the resolver DNS at the time of the installation
	- Configuration with external DHCP
	- Problem with LDAP server (sradutmp is no more needed) 
NEWS
	- integration of an internal DNS in automatic configuration (alcasar-dns-local.sh)
	- "SMS autoregistration" link in the 'intercept' page (if the service is enabled)
	- It's now possible to update via ssh
ACC
	- show user info (name & surname) in the "activity" screen (if set)
------------------------2.9 ------------------------

BUGS
	- Configuration radius with PAP module (remove a warning)
	- Fix an issue when INTIF is a Gb/s card (generic-receive-offload : off)
NEWS
	- Mageia 4.1 migration
	- Remove Squid - Add Tinyproxy
	- Add the SMS auto-registration system
	- Add whitelist filtering (domains and related IP addreses) 
	- Add IP addresses of the Toulouse blacklist in the firewall targets
	- Add whitelist/blacklist/antivirus filtering by users/groups
	- Add surfmap plugin (nfsen)
	- Store user password in SHA256 instead of MD5 (Thanks to Olivier HOUSSENBAY) and use a random SALT (not same hash for two same passwords)
	- Add Network tool statistic : Vnstat
	- BL/WL/Antivirus filtering now works with MAC authentication
ACC
	- simplify the user registration menu
	- import a file containing a list of blacklist ip addresses or DNS names (ie : CERT)
	- reboot or halt the system is now possible
------------------------2.8.1 -----------------------
BUG	- a security hole has been patch (EDB-ID: 34595 - OSVDB-ID: 111026)
	- In the intercept page, fix the behaviour (loop) when the user writes "logout" as url
	- correction in "session time" radius counter (thanks to Olivier HOUSSENBAY)
----------------------- 2.8  -----------------------
BUGS	- The file "alcasar-services" is now sorted
	- New graphic option in grub conf file in order to fix issues with mini-itx-ATOM moterboard
NEWS
	- Firewall-eyes and AWstat are removed from ACC
	- The user attribute "Max_total-time" is now "authorized period after the first connection"
	- Creation of a netflow probe (kernel module)
	- complete network statistics can be viewed in ACC (nfsen)
	- The porttracker nfsen module allows to view network statistics by protocols
	- The imputability files are now included in a single archive file (one per week)
	- The Alcasar name includes the domain name ('localdomain' by default). We prepare the future when we will include the domain name of company.
----------------------  2.7.2  ---------------------
BUGS	- Modify the unit 'radiusd.service in order to wait for mysql
	- Creation of an unit 'loadbalancing.service' instead of init.d script
	- Removing the rc.local file
NEWS
	- Add fail2ban on the following attacks : ssh, https (ACC admin page), Unix accounts
	- Creation of a security page in the ACC : fail2ban alerts, virus stopped by havp+clamav, MAC addresses bloqued by the watchdog process (usurped) 
----------------------   2.7.1  -----------------
BUGs
	- Fix multi-users voucher
	- Fix a mageia2 bug in network function
NEWS
	- Add 2 examples of "uamalowed and uamdomain" files with several microsoft update domains
	- Show the blacklist category in "Acces denied" page
	- Watchdog : don't disconnect MAC auth equipments even if they can't be reached (arping)
----------------------   2.7  -----------------
BUGs
	- some corrections in the connection popup
	- test if categories enabled of the BL are effectively in the BL (need after an update of the BL)
NEWS
	- Installation with Mageia2
	- The URL filter works with the new google safesearch regex ('safe=strict' instead of 'safe=vss')
	- The safesearch for google works now with https (redirect on 'nosslsearch' proxy)
	- The WhiteList architecture is enabled
	- All the documentation has been translated in english
	- The security certificate is now signed in sha256
	- Balancing connection is now operational and dynamically checks the Internet connectivity
Core improvements
	- HAVP doesn't scan youtube flows (too heavy load / no risk)
	- voucher can now be done in multi-users 

----------------------   2.6.1  -----------------
Bugs
	- The embedded documentation is in right version
	- fix the dhcp static address for eth1 (intif) 
ACC
	- show user information when trusted equipment are listed (better than only MAC address)
	- main page : doesn't show the date of installation in the version field (can be confused)
Install
	- show the GPL
----------------------   2.6.0.1  -----------------
Bugs
	- the deleted library fpdf has been restored
	- the mysqld and radiusd services are restarted when ALCASAR is launched
----------------------   2.6   --------------------
Bugs
	- "username" in "userinfo" table is varchar(64) like in others tables of ALCASAR database.
	- "activity.php" : don't print "private_ip_address". Update with new "chilli_query" output
	- re-activation of COA between radius and coova (radius disconnect the users directly).
	- the "url-redirect" attribute now works fine (coovachilli V.1.2.9-1)
Core improvements
	- all "alcasar.info" becomes "alcasar.net" in code
	- change the order of http chain (DG --> squid --> HAVP --> Internet) more r√©activity and less charge of CPU
	- Dansguardian deny domains when requested via proxy http
	- The database is checked (and repair) every week
security improvements
	- The blacklist is now verified before activating (ANSSI need)
	- The school/parental control can now filter search engines (google, bing, yahoo, matacrowler, etc.) and Youtube 
News
	- When IP addresses in the consultation network are dynamicly allocated, static ip can be reserved in the Alcasar Control Center
	- The script "alcasar-https.sh {-on|-off}" enable or disable encryption of authentication flows
	- Exceptions of authentication (@MAC) are now managed by Radius (like other users)
	- @network and @Host can be blocked by the firewall (conf file : etc/alcasar-ip-blocked). Alacasar Control Center is updated.
	- the filtering of LAN between ALCASAR and the Internet GW is no more need.
	- DHCP service is more flexible : it can be {off | half | full}
	- ACC : admin can now export the curent tracability file
	- ACC : admin can define the exception domains that will be showed in intercept page
	- A new user attribute "max-all-session" is managed (maximum time a user can be connected)
	- ACC : The english translation is more complete.
	- clears the script "alcasar-mysql.sh --expire_user" users having an expiry date than 7 days
	- user pages translations in portugese
	- voucher ticket with logo of organism
	- intercept page with exception links
	- the needed RPM for ALCASAR can be downloaded with the new script "alcasar-rpm-dowmload.sh" 
----------------------   2.5   --------------------
Bugs
	- watchdog of Daemons for service's test
	- watchdog (and script alcasar-logout.sh) doesn't logout the macallowed addresses
	- reading of alcasar.conf file parameters more securely
	- don't download RPMs twice
	- allow connexion to an LDAP server on WAN side
	- control that watchdog can't execute if already running
	- allow FTP in output
	- eth1 is no more configured. Tun0 works better (only one arp cache)
	- modoarchive is deleted (too many bugs and too hard to debug)
Core improvements
	- new alcasar-iptables.sh script (more logically strutured)
	- update phpsysinfo page ("Internet access flag" nom show the right status)
	- Authenticate user on Mysql when LDAP server is down
	- import users via text file with or without password
	- last version of coova-chilli
security improvements
	- The 8080 (TCP) and 53 (UDP) ports are now hidden on Lan side
	- ANSSI code review (sql escape string in PHP)
	- remove the apache unused modules
	- the blacklist is no more update automaticly
	- postfix banner is more secure
	- anonymisation of squid (+ remove of 'x_forwarded' rule)
installation improvements
	- control eth0 config on startup (no dhcp)
	- don't download the last BL version
	- remove unused RPM before update the system
	- Improve when update is performed via SSH
News
	- allow/deny access to the LAN located between ALCASAR and the Internet gateway (box)
	- presentation and installation doc in english

----------------------   2.4   --------------------
Bugs
	- some minor bugs (log rotate, intercept page, squid, ...)
	- ACC : correction of the Internet connectivity test flag
	- correction of the network filtering flag
	- ip filtering exception changes doesn't active protocols exception filter
	- remove dual log archive
	- correction in "bypass" mode
	- correction with squid cache
	- The blacklist is automaticly updated once a month
	- The distribution is automaticly updated every day

----------------------   2.3   --------------------
Bugs
	- group properties are now written on the voucher
	- hold the state of network filter when update
Core improvements
	- simplify official certificate import process
	- update with the last version of Coova (1.2.8)
security improvements
	- end of implementation of ANSSI rules for netfilter
News
	- allow exception of IP addresses (or network addresses) in the authentication process
	- ACC : group member is added in user list

----------------------   2.2   --------------------
Bugs
	- A bug with "sudo" is bypassed 
	- improve the script which display and close users open sessions
	- some minor bugs
Core improvements
	- add a central conf file (/usr/local/etc/alcasar.conf)
	- IP parameters can be change in central conf file. Apply with the script "alcasar-conf.sh -apply"
	- 'alcasar-nf.sh' and 'alcasar-bl.sh' scripts now use the global parameters file (alcasar.conf)
	- improve the script which managed the trusted sites and urls
security improvements
	- close all accounting session when the system goes down or up
installation process improvements
	- allow change of alcasar IP private address during install stage
	- no more question, when upgrating
News
	- blacklist category "ip" is added for url that contains only an ip address (no FQDN)
	- allow LDAP/AD connections both on WAN and LAN
	- Add a LDAP connectivity test
	- possibility to redirect users on a specific URL after login process
	- if activate, sshd listen both on LAN and on WAN
	- ACC : add the equipment name in the activity window when MAC authenticate

----------------------   2.1   --------------------
- mise en conformit√© du parefeu avec les pr√©co ANSSI (politiques √† DROP + sysctrl) 
- am√©lioration de la fonction bastion en limitant la charge sur l'interface externe (thanks to CPN) 
- am√©lioration de la gestion des RPM 'wget' au lieu de 'curl' et changement de repository en 'live'
- exception au filtrage r√©seau et DNS (double instance de dnsmasq)
- ajout d'un commentaire pour les exceptions √† l'authentification
- possibilit√© d'imprimer un ticket de session  et simplification des champs de saisie (thank's to Geoffroy MUSITELLI)
- nouveau look graphique (thank's to St√©phane Erard)
- page de status via JSON (thank's to St√©phane Weber)
- int√©gration du filtrage 'safesearch' (filtrage des r√©ponses des moteurs de recherche).
- installation √† partir d'un mandriva 2010.2
- diminution des ressource syst√®me (travail d'HAVP en m√©moire plut√¥t que sur le disque)
- distinction des fichiers de log (tra√ßabilit√© - ssh - acc√®s exterieur)
- am√©lioration du processus de mise √† jour (prise en compte du num√©ro de version)

---- 2.0.1 ----
- simplification du processus de mise √† jour (prise en compte mdv 2010.2)
- d√©placement du r√©pertoire 'digest' vers /usr/local/etc/
- correction horodatage des logs awstat
- inclusion d'un fichier de nommage DNS local
- inclusion d'un fichier 'alcasar-ethers' permettant la r√©servation d'adresses IP par Dnsmasq
- inclusion d'un fichier 'alcasar-dns-name' permettant de d√©finir des associations @IP <--> DNS par Dnsmasq
- qq bugs mineurs (ntpd, adresse coova 1.0.0.0, etc.)

---- 2.0 ----
- mise √† jour de la documentation technique
- ajout des switchs en '--' pour remplacer les '-' des scripts
- acc√®s authentifi√© √† la la page de garde du centre de gestion
- Prise en compte du script "alcasar-iptables-local.sh" dans le cadre du ByPass
- Prise en compte des cat√©gories de la BL dans l'interface de gestion
- prise en compte par le watchdog de la redirection usager si panne eth0 ou panne default-gw
- Simplification de la proc√©dure de mise √† jour
- Int√©gration du filtrage de domaine via dnsmasq (DNS-blackhole)
- suppression de named du script d'alcasar
- Int√©gration des blacklists de dansguardian et formatage pour dnsmasq
- Int√©gration de la migration du syst√®me de la Mandriva
- Int√©gration de dnsmasq en lieu et place de named et dhcpd ( en mode normal) en bypass dhcpd et toujours pr√©sent ...
- Prise en charge du fichier alcasar-iptables-local.sh dans l'update

---- 1.9 ----
- Adaptation de DHCPD dans les scripts de demarrage
- Mise en place du DHCPD local en lieu et place de DHCP Chilli : "alcasar.sh"
- Ajout de la gestion des quotas sur les usagers et groupe d'usagers.
- Interdiction de cr√©er des usagers ou groupes avec un nom vide ou contenant des espaces
- cr√©ation RPM 32b et 64b d'havp. Adaptation des scripts.
- int√©gration havp + clamav
- remplacement de valeur DNS1 et DNS2 quand valeur= vide ; test√©
- R√©√©criture de la proc√©dure d'installation des RPM (t√©l√©chargement et test avant install)
- protection du menu "grub"
- Fusion menus "services" et "r√©seau"
- "page de garde" : simplification + Info sur le filtrage + optimisation
- "menu.php" : prise en compte version 'actuelle' et 'MAJ" dans la page de menu
- prise en compte version 'stable' et 'devel" dans la page de garde
- correction bug (adresse en 0.0.0.0 du menu activit√©)
- mise en place des properties svn avec $Revision  $Date
- mise en place des exceptions au filtrage (web + r√©seau). Correction bug utf8.
- "alcasar.sh" : modif config carte eth0 (dns local et ifcfg-eth0.default) 
- bascule du d√©veloppement sur subversion
- "alcasar.sh" : debug de la partie "mise √† jour" + ajout de la zone reverse (localdomain.rev)
- "alcasar.sh" : correction config coova (les DNS sont pr√©-renseign√©s dans la conf par d√©faut). Ajout de l'entr√©e "alcasar" dans la zone DNS "localdomain"
- "alcasar.CA" : renommage des "OU" et pr√©paration d'un deuxi√®me certificat serveur pour le CN "alcasar"
- "alcasar.sh", "alcasar-conf.sh" : procedure externe pour cr√©er l'archive des fichiers de conf
- "alcasar.sh", "alcasar-uninstall.sh", "alcasar-CA.sh", "alcasar-conf.sh" : r√©√©criture de la proc√©dure de mise √† jour
- "alcasar-iptables.sh" : suppression DNS sur TCP (uniquement UDP)
- "alcasar-urpmi.sh" : prise en compte de la "mirrorlist" centralis√©e chez Mandriva
- "alcasar.sh" : suppression des daemons ifplugd associ√©s √† chaque carte r√©seau (mii_not_suported=yes)
- durcissement de l'entr√©e du nom d'organisme (pour les 2 mains gauches ;-)   )
- "service.php" : ajout du service "named"
- "alcasar-iptables.sh" : rajout des redirections et autorisations tcp domain dans parefeu 
- "alcasar.sh"		 : activation du DNS bind   [install uninstall(alcasar-uninstall.sh) et update]
- "intercept.php" : int√©gration de la variable "userurl" dans les arguments de la demande d'authentification afin que la page demand√©e par l'usager soit prise en compte par le cache ARP de chilli (et donc affich√©e apr√®s l'authentification) ouf...  ;-)
- "intercept.php" : suppression caract√®res superflus ("\"). Ajout variable "urladmin" : permet de choisir la page charg√©e apr√®s authentification
- "alcasar.sh" : fonction 'chilli' -> creation du fichier d'exception par @mac (alcasar-macallowed)
- "menu.php", "auth.php", "filtering.php" : modification du menu
- "exception.php" : int√©gration php de la gestion des exceptions par @MAC + traduction
- "alcasar-iptables-filter.sh" : correction bug sur le nom du chemin du fichier ligne 30 
- "alcasar-iptables.sh" : int√©gration Bind ( mais non activ√© )
- "alcasar.sh" : + int√©gration de Bind ( mais non actif pour le moment )
- Int√©gration de param_bind dans menu -install et -update
- ln et modification de /etc/trusted_network_acl.conf ( LAN autoris√© √† query )
- radius et update RPM : --> suite aux probl√®mes d'update RPM ( √† affiner si suppression de certains modules radius ( rlm_, etc...)
- rajout/modification de droits msec sur /etc/raddb 
- touch sur control-socket, default et inner-tunnel sous /etc/raddb/site-enabled (ln rajout√©s par un update RPM de freeradius syst√©matiquement ... et qui emp√™che le d√©marrage de radius)
- "alcasar.sh" : mise √† jour de l'install ntpd ("ntpdate" √©tant devenu obsol√®te)
- "alcasar-uninstall.sh" : suppression des sp√©cificit√©s de la V1.7
- intercept.php : correction bug (compatibilit√© ie8).
- mise √† jour du r√©pertoire "conf/rpms-update" (rpm de "mindi" compatible ext4) 
- "alcasar-mondo.sh" : correction propos√©e par Michel GAUDET
- ajout du processus "sshd" dans la page "syst√®me/services".
- "alcasar-radius" : suppression des tags config- de l'ancien plugin ldap.
- "alcasar.sh" : augmentation de la taille des fichiers en "upload" par php (pour l'import de la base usager)
- le service sshd n'est plus lanc√© automatiquement au d√©marrage (activable via l'interface de gestion)
- "alcasar-iptables-filter.sh : a voir avec richard pour les conntrack modules pour ftp ...
- "menu.php, filtering.php, activity.php" : prise en compte des @mac autoris√©e dans la fen√™tre "activit√©" (+ corrections)

---- 1.8 ----
- "alcasar-bypass.sh" : am√©lioration du script
- cr√©ation des 2 scripts d'initialisation des daemons "chilli" et "dansguardian"
- "alcasar.sh" et "alcasar-uninstall.sh" : cr√©ation de la fonction "dansguardian"
- "alcasar.sh" : int√©gration du RPM "coova-chilli" r√©alis√© par Mandriva.
- mise √† jour des docs
- "alcasar-iptable-bypass.sh" : adaptation √† la derni√®re version de netfilter.
- "alcasar-iptable-filter.sh" : traitement du filtrage ICMP
- "alcasar.sh" : d√©sactivation par d√©faut du filtrage WEB et du filtrage r√©seau
- "alcasar-iptables.sh" + "alcasar-iptables-filter.sh" : optimisation des r√®gles de filtrage. 
- ajout du charset (utf-8) dans intercept.php
- adaptation de phpsysinfo : (portail.php, index.php, fr.php et en.php)
- "alcasar-CA.sh" : suppression des caract√®res superflus lors de la g√©n√©ration du certificat de l'A.C.
- "service.php" : mise en conformit√© graphique
- mises √† jour network.php (internationnalisation et suppression des erreurs php)
- alcasar-urpmi.sh et alcasar.sh : adaptation de la proc√©dure de mises √† jour pour les architectures 64b
- mises √† jour des fichiers de la partie "syst√®me" du centre de gestion (internationalisation, utf8... partie √† finaliser...)
- int√©gration de la page activit√© dans "syst√®me/r√©seau" et adaptation du menu
- adaptation du code aux √©volutions php5 (fonction "split" d√©pr√©ci√©e, fonction "new" retourne directement une valeur, variables _get et _post interdites de visibilit√© globale)
- fichiers modifi√©s : intercept.php, uam.php, net-filter.php, bl.php, bl2.php, sauvegarde.php, 15 fichiers de phpsysinfo, to be continued ...
- "alcasar.sh" : adaptation pour le module 'ldap') :
- "alcasar.sh" : adaptation √† MdV-2010, corrections : log_martians, lancement des fonctions, rpm orphelins 
- tri des services, am√©lioration des fonctions php d'ouverture de fichiers (bl + wl)
- prise en compte d'une whitelist par protocole autoris√© (cr√©ation du fichier /usr/local/etc/alcasar-services)
- "alcasar.sh" : suppression de l'√©coute sur le port 80. Suppression du filtrage ultrasurf. Evolution de la gestion du filtrage (alcasar-nf.sh + modules php)
- "alcasar.sh conf/logrotate.d/dansguardian" - adaptation de dansguardian dans la rotation des logs et modif du script alcasar.sh
- "alcasar.sh" : suppression du filtrage des fichiers t√©l√©charg√©s, mise √† jour syst√®me automatique, modif page d'erreur apache "401", limitation de l'√©coute d'apache sur le port 443 (eth1)
- "alcasar-unistall.sh : mise √† jour
- Modification du menu de centre de gestion : ajout menu systeme(services/r√©seau/ldap)
- Ajout des pages de configuration des Services, R√©seau et LDAP.
- "alcasar.sh" : modification des msec local (perm.local) --> prise en compte de l'interface ldap --> a confirmer
- "alcasar.sh" : adaptation des d√©lais pour anacron 
- "alcasar-iptables-filter.sh" : debug de la ligne de r√©cup√©ration des @IP ultrasurf
- "alcasar-iptables.sh" : adaptation des r√®gles √† la nouvelle norme d'√©criture (le "!" plac√© avant)
- "alcasar.sh" : adaptation du module "radius" pour mandriva 2009.0 & 2009.1
- "alcasar.sh" : suppression du filtrage d'URL via les expressions r√©guli√®res (REGEX) pour dansguardian
- pr√©mices de l'interface de filtrage r√©seau (alcasar-nf.sh + modules php)
- "alcasar.sh" : g√©n√©ration de mot de passe al√©atoire au sein des briques Alcasar m√™me apr√®s une mise √† jour.
- mise √† jour de "mondoarchive" et "mindi" dans l'archive des RPM (alcasar-1.8-rpms.tar.gz)
- "alcasar.sh" : modif de la conf dansguardian (afin de pr√©parer l'interfa√ßage graphique)
- 'alcasar-uninstall.sh" : mise √† jour et d√©sinstallation compl√®te de mysql
- "alcasar.sh" : pour Dansguardian, on d√©sactive le contr√¥le dans l'URL, on bloque les URL avec @IP, on bloque le https par le port 80
- "sauvegarde.php" : suppression de l'affichage des journaux du proxy
- ajout de 3 RPMs li√©s au "backportage" de "mondo-mindi"
- "alcasar.sh" : ajout des cron.d/export et clean pour une prise en compte en cas d'arr√™t du serveur pendant l'ex√©cution
- "alcasar.sh" : suppression des # dans le plugin_ldap ( ne prend pas en compte le lancement multiple ...
- "alcasar-log-export.sh, alcasar-log-clean.sh, conf/logrotate.d/dansguardian" : prise en compte des logs de dansGuardian ... dans les exports de logs et le nettoyage # a voir si on garde ?
- "alcasar.sh" : prise en compte de la tabulation avant et derri√®re le # dans radiusd.conf
- "alcasar-mondo.sh" : suppression du param√®tre -F qui crash sur la Mandriva 2009.1
- "alcasar-bl.sh" : mise √† jour des liens internes li√©s au t√©l√©chargement de la BL Toulouse 
- "phpsysinfo" : activation de la barre de charge (load-bar) dans la page d'accueil
- correction bug : affichage des exceptions (bl.php) et sauvegarde du fichier "/etc/dansguardian/exceptioniplist" en cas de mise √† jour 

--- 1.8a ---
- modif du syst√®me de comptage des usagers en ligne de la page d'accueil (chilli_query au lieu de radwho)
- am√©lioration de la fonction de mise √† jour
- d√©finition al√©atoire des mots de passe inter-processus (alcasar.sh)
- r√©√©criture des r√®gles iptables pour pr√©venir l'impossibilit√© future de filtrer sur la table NAT (alcasat-iptables.sh)
- possibilit√© de garder l'ancien certificat serveur lors de la mise √† jour
- installation de dialupadmin + conforme (uniquement les fichiers modifi√©s)
- r√©architecture des pages du centre et homog√©n√©isation graphique.
- correction javascript dans la page d'interception
- possibilit√© de supprimer les usagers √† la suppression de leur groupe
- correction faille de conf apache (suppression de la directive "method")
- gestion des profils d'administration en 3 groupes (admin, manager, backup)
- correction de la "double redirection" lors de l'interception par coova
- suppression de la fonction "OnBlur" de intercept.php
- am√©lioration de la conf de squid (suite au remplacement de squidGurad par Dansguardian)
- am√©lioration de la rubrique "activit√© r√©seau" (affichage tri√© et d√©connexion d'un usager (m√™me si plusieurs sessions simultan√©es)
- modification des menus de l'interface
- correction d'un bug et "durcissement" de la conf de coova-chilli √† l'install (alcasar.sh)
- remplacement "hotspotlogin.cgi" par "intercept.php". Traduction en 5 langues. Prise en compte des r√©ponses Radius.
- simplification des scripts de modification du mot de passe usager (+ traduction 5 langues)
- affichage du nom d'organisme sur la page d'interception
- correction de bug dans "alcasar.sh" : appel de 'htdigest' par son chemin complet, am√©lioration des calculs pour les r√©seaux de classe A et B, proc√©dure de mise √† jour (option -update)
- correction du fichier "dhcpd.conf" (ajout de l'entr√©e "ddns-update-style interim")
- correction et agr√©gation des 2 scripts "alcasar-bypass-on / off"

--- 1.7 ---
- int√©gration du module de filtrage applicatif
- traitement des vpn https "ultrasurf" (contournement du filtrage d'URL)
- mise en conformit√© de l'interface des sites de confiances ("uamallow" et "uamdomain")
- mise √† jour de la doc
- module graphique de visualisation de l'activit√© du r√©seau de consultation (√©quipements et usagers)
- correction bug "sauvegarde.php"
- correction bug freeradius-web/lib/sql/drivers/mysql/functions.php (merci M.G.)
- adaptation cron de chilli √† notre logique (/etc.cron.d au lieu de /var/spool/cron/root)
- suppression des mails pour les cron journaliers (awstat, chilli, etc.)
- modification radius (√©criture dans sradutmp et radutmp) --> r√©cup√©ration de la fonction "radwho"
- relooking type Alcasar de "accounting.php" et suppression d'affichage des champs "NAS*"

--- 1.7-rc4 ---
- recodage UTF8 alcasar.sh, alcasar-iptables, etc.
- modif alcasar-iptables (le "/etc/init.d/iptable save" est r√©alis√© ici) et alcasar-iptables-filter (ancien alcasar-iptables-local) en vue d'int√©grer le filtrage applicatif.
- agr√©gat uam.php + uam2.php (suppression uamallow.php et alcasar-uamallow.sh)
- s√©curisation /etc/pki
- modification et int√©gration du fichier de conf "radiusd.conf" + conforme
--> gestion de la casse pour les noms d'usager
--> suppression des m√©thodes d'authentif inusit√©es
--> activation des compteurs SQL (module rlm_sqlcounter.so)
- remplacement "ssmtp" par "postfix" afin de pr√©parer l'avenir ;-)  et d'√©viter les erreurs de "crond"
- cr√©ation et mise en ligne de l'archive des RPMs additionnels pour les installation "faible d√©bit"
- phpsysinfo : nom de la distribution de nouveau disponible (phpsysinfo/distro.ini <-- Mandrivalinux au lieu de Mandriva)
- adaptation de admin/uam.php ( et uam2.php) pour g√©n√©ration web des urls et domaines de confiance
- suppression de shorewall-common et pas uniquement shorewall
- int√©gration dans /etc/chilli/config de alcasar-uamallowed et alcasar-uamdomain (fichiers de sites et de domaines de confiance)
- modif de alcasar-iptables.sh pour permettre l'icmp sur INTIF et pas seulement sur TUNIF
- modif alcasar-uamallowed.sh pour int√©grer un fichier alcasar-uamdomain ( domaines sans restriction)
- modif "sauvegarde.php" pour ordonner la liste des sauvegardes (base, firewall, syst√®me)
- modif "hotspotlogin" pour int√©grer un traitement √† la fermeture du popup de d√©connexion
- modif /etc/alcasar-bypass.sh en /usr/local/bin/alcasar-iptables.bypass.sh
- modif alcasar-bypass-local.sh pour int√©grer des filtres applicatifs + d√©placement dans alcasar-iptables.sh
- int√©gration coova "+ conforme" (modif du fichier de conf par d√©faut)
- suppression des modifs iptables effectu√©es par coova (/etc/chilli/up.sh)
- ajout du contr√¥le des flux DNS (pour √©viter les tunnels DNS)
- remplacement de la page d'interception de dansguardian
- int√©gration du module LDAP dans /etc/raddb et alcasar.sh

--- 1.7-rc3 ---
- Correction bugs dans "alcasar-log-export"
- Suppression des broadcast sur EXTIF
- Suppressions des envois de mail pour cron (g√©n√©rait une erreur en absence de MTA)
- correction config awstat et int√©gration graphique
- int√©gration Squid "+ conforme" (modif du fichier de conf par d√©faut)
- suppression du snmp_finger inutile dans "/etc/freeradius-web/admin.conf"
- correction du bug mktime() de la page "stat journali√®re"
- modif menu pour les pages "stats journali√®res" et "stat usagers"
- correction bug de la page des connexions actives ("sradutmp" dans "/etc/raddb/site-available/alcasar" et @IP r√©elle du NAS (et non loopback))
- int√©gration du plugin ldap : les scripts php ne sont pas retenus (mais conserv√©s).
- impl√©mentation et adaptation pour authentification seule (pas de r√©cup√©ration des attributs Radius dans ldap )
- ajout de la commande service dans sudoers ; pourra √®tre utile pour ins√©rer l'√©tat des services utiles (status et restart) dans phpsysinfo
- ajout des fichiers modifi√©s ldap.attrmap et ldap (sera modifi√© par le script plus tard :-) issus de freeradius-ldap
- modification du fichier d'installation alcasar.sh pour rajouter une option -ldap ind√©pendante de l'install/update et uninstall

--- 1.7-rc2 ---
- correction de code php afin de supprimer les warnings dans /var/log/http/ssl_error
- correction de quelques coquilles
- int√©gration de la gestion des sessions simultan√©es
- correction bug dans la page d'info usager - rubrique "password-check" (freeradius-web/lib/sql/password_check.php)
- int√©gration du travail de P.Romero (g√©n√©rateur de mots de passe al√©atoires dans htdocs/user_new.php et htdocs/user_edit.php)
- suppression des log_martian via msec -> fichier /etc/security/msec/level.local (alcasar.sh)
- ajout des RegEx de saisie d'adresse IP (alcasar.sh)
- cr√©ation du script de gestion des profils "alcasar-profil.sh", adaptation d'alcasar.sh
- correction bug sauvegarde.php : r√©pertoire "/var/Save/log/proxy" au lieu de "/var/Save/log/squid",
- correction d'un bug dans le fichier de conf d'awstat
- ajout de la possibilit√© de changer le plan d'addressage √† l'install, correction bugs date d'installation + install via archive RPM

--- 1.7-rc1 ---
- int√©gration page uamallowed, modification du menu, lien symbolique /etc/radius/radutmp sur /etc/radius/sradutmp (pour radwho --> √† revoir), v√©rif mdp chiffr√© dans mysql --> ok.
- modif archive RPMS, iptables, squid.conf (pour ce dernier, on devrait pouvoir partir du fichier de conf de base)
- suppression des paquetage avahi, mandi, shorewall, drakxtool-curses et les orphelins cr√©√©s (√† la fin de l'install)
- cr√©ation de l'archive rpm optionnel "alcasar-rpms.tar.gz" (n√©cessaire quand on a pas Internet (dans le train par exemple ;-)  ))
- d√©placement de /etc/chilli/defaults en /etc/chilli/defaults.old pour √©viter les uamallowed ins√©r√©s automatiquement par coova
- modif import-user.php, d√©placement dans freeradius-web/htdocs (en import_user.php) et modif page d'appel (usager.php)
- correction des requetes SQL sur la table "usergroup" au lieu de "radusergroup" (import_user.php et portail.php). Correction du MCD.
- suppression de l'affichage du logo "coova" (/etc/chilli/config)
- suppression des log parefeu https, ssh et dhcp (les logs des daemon httpd, sshd et coova suffisent)
- suppression de la modif du fichier syslog.conf √† l'install
- mise √† jour de la page d'interception (hotspotlogin)
- mise √† jour alcasar-uninstall, config ssh, alcasar-bypass-iptables
- affectation dynamique du role des cartes RSO (alcasar.sh)
- correction de bugs (alcasar-iptables.sh + alcasar.sh)
- g√©n√©ralisation de l'utilisation des variables "intif" et "extif" dans le script d'install
- prise en compte des nouvelles structure des RPM repository (alcasar-urpmi.sh)
- adaptation du script d'install en mandriva 2009
- int√©gration native de coova-chilli

--- 1.7 ---
- Suppression de l'enregistrement du mot de passe dans la table "radpostauth"
- int√©gration dans alcasar.sh √† l'installation-update
- int√©gration structure ossi-bl et ossi-wl dans squidGard.conf et alcasar.sh --> reste dans script web
- int√©gration de coova-chilli en substitution √† chillispot ;  reste √† int√©grer dans alcasar.sh √† l'installation-update
- modif import_user.php :
- remont√©e de import_user.php √† la racine du centre de gestion ; modification dans les diff√©rentes interfaces dont les menus
- sortie sur un fichier unique  ; reste √† r√©cup√©rer par le biais de l'interface
- modif chilli.conf : interval=0 (√©vite le relancement de chilli toute les heures)

--- 1.6 ---
- Durcissement du parefeu (fermeture de ports) et adaptation des r√®gles √† l'interface "firewalleyes"
- Simplification de la structure des fichiers de sauvegardes (/var/Save)
- Mise √† jour du fichier de configuration squidGuard (int√©gration de tous les domaines de la BL de Toulouse)
- S√©paration des RPM additionnels de l'archive du portail
- R√©√©criture du script de g√©n√©ration des certificats de l'A.C et du serveur WEB
- Automatisation de la proc√©dure de mise √† jour
- Am√©lioration de l'interface de gestion :
	- Meilleure int√©gration graphique et francisation
	- Prise en compte des cr√©neaux horaires, de la dur√©e des sessions et de la date d'expiration du mot de passe
	- Suppression du menu certificat (int√©gration dans la page d'accueil)
	- Refonte de la page de gestion des blacklists et rationalisation des scripts php associ√©s
	- Import d'usagers (√† partir d'un fichier texte ou d'une base compl√®te) et RAZ de la base
- D√©connexion des usagers par ALCASAR (radiusd + chilli) et non plus seulement par le navigateur WEB (param√®tre 'coaport')
- Modification squid.conf (compatibilit√© toute distrib MDV).
- Simplification du module de cr√©ation de l'image syst√®me (alcasar-mondo.sh).
- Correction des bugs suivants :
	- Disparition des statistiques de consultation web apr√®s une mise √† jour
	- Deconnexion d'un usager √† partir de l'interface de gestion
	- possibilit√© de cr√©er des groupes vides (en fait avec un usager virtuel portant le m√™me nom que le groupe).
- Cr√©ation des scripts alcasar-bl.sh (activation/d√©sactivation/mise √† jour du filtrage), alcasar-logout.sh (d√©connexion des usagers) et alcasar-mysql (import usagers via txt et sql + raz de la base).

--- 1.5 ---
- prise en compte du nom de bapt√™me du portail : ALCASAR
- int√©gration d'un script PHP permettant de personnaliser le logo
- int√©gration du contournement du bug 'MSIE' pour les pages gestion.
- Int√©gration de l'interface PHP d'informations syst√®me ( phpsysinfo) et ajout d'un module Alcasar (nbr.usagers, version d'installation, version de la blacklist, @IP publique).
- R√©√©criture des scripts d'install et de d√©sinstall (alcasar-uninstall.sh)
	- int√©gration d'un test de connectivit√© √† Internet
	- r√©organisation des fonctions
	- cr√©ation de l'option 'uninstall' permettant de d√©sinstaller compl√©tement le portail (afin de pouvoir lancer des s√©quences d'install/d√©sinstall pour les tests)
	- permettre le choix du nom pour les comptes autoris√©s √† administrer le portail
- R√©√©criture de la page de gestion et int√©gration des fonctionnalit√©s nouvelles suivantes :
	- mise √† jour de la blacklist squidGuard (globale + OSSI)
	- sauvegarde √† chaud du syst√®me, sauvegarde des logs et de la base usagers
	- visu des logs du parefeu
- Modification du fichier sudoers permettant le lancement des commandes via la page de gestion
- Ajout de l'option -update pour mettre √† jour le portail d√©j√† install√© (option compatible avec versions >= 1.5)
- Am√©lioration des r√®gles du pare-feu (moins de Logs mais plus pertinents)
- Gestion des erreurs 404 d'apache par une redirection sur la page d'accueil
- Possibilit√© de changer son mot de passe via la page de connexion et la page de gestion
- Correction des bugs suivants :
	- la comptabilit√© utilisateur dans dialupadmin est de nouveau fonctionnelle
	- l'export chaque semaine de la base des utilisateurs est de nouveau fonctionnel
	- homog√©n√©isation de la gestion des cron ==> tout dans /etc/cron.d/
	- d√©placement de la structure d'awstat pour permettre la visu compl√®te des pages (var/www/awstats -> /var/www/html/awstats)
- Int√©gration d'une interface PHP de lecture des log du parefeu ( firewallEyes )
- Impl√©mentation du certificat gnupg pour le chiffrement √©ventuel des logs
- Modification mineure du script de g√©n√©ration √† chaud d'image syst√®me (alcasar-mondo.sh)
- Modification des pages de dialupadmin ( francisation, simplification, etc.)
- Int√©gration dans le fichier archive des rpms suppl√©mentaires et de la blacklist (√©vite leur t√©l√©chargement par internet)
--- 1.4 ---
- R√©√©criture du script de mise √† jour de la blacklist squidGuard
- Uniformisation du script d'install
- Correction du script de d√©sinstallation (alcasar-uninstall.sh) et de sauvegarde de la base radius (alcasar-mysql.sh)
- Mise en place d'une page WEB d'accueil pour la gestion du portail
- Suppression des cgi-bin install√©s par d√©faut
--- V1.3 ---
- Cr√©ation d'une structure 'OSSI' dans la blacklist SquidGuard
- Modification de la page d'interception SquidGuard.
- Anonymisation de la structure LAN dans les trames trait√©es par Squid (forward_for off dans squid.conf).
- Correction de la fonction 'bypass'.
- Mise en place de la possibilit√© de chiffrer les logs (par gnupg).
- Correction du mot de passe dans le script d'export lorsqu'il est chang√© √† l'install.
- Correction de la structure d'archivage et prise en compte du contenu des fichiers √† sauvegarder.
- Mise en place du cron de sauvegarde des configurations.

--- V1.2 ---
- Consolidation de la fonction de d√©sinstallation (cr√©ation syst√©matique de fichiers '.default' lors de modification)
- Configuration des services lanc√©s au d√©marrage (chkconfig).
- Fran√ßisation du CGI "hotspotlogin" (codage des accents).
- Possibilit√© de lancer le script sans argument (-all par d√©faut).
- Suppression des "Logs Martians".

--- V1.1 ---
- Consolidation de la variable FIC_PARAM.
- Suppression de la d√©claration des DNS dans le fichier de conf de chilli (on s'appuie sur les DNS locaux d√©finis dans "/etc/resolv.conf").
- Modification de la page d'authentification (plus g√©n√©rique).
- R√©organisation de la structure de l'archive d'install.
- Modification des directives de chiffrement d'apache (SSLRequireSSL).

--- V1.0 ---
- Version initiale que l'on trouve d√©j√† excellente ;-)
